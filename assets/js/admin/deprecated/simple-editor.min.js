!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.simpleeditor={})}(this,function(exports){"use strict";var t,e,$=window.jQuery||window.$,o=0,n=0,i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},r=function(t,e,o){return $(t).on(e,o),function(){$(t).off(e,o)}},l=function(t,e){return $(t).prepend(e)},a=function(t){return document.createElement(t)},s=function(t){return document.queryCommandState(t)},d=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return document.execCommand(t,!1,e)};window.getSelection&&document.createRange?(t=function(t){var e=t.ownerDocument.defaultView.getSelection().getRangeAt(0),o=e.cloneRange();o.selectNodeContents(t),o.setEnd(e.startContainer,e.startOffset);var n=o.toString().length;return{start:n,end:n+e.toString().length}},e=function(t,e){var o=t.ownerDocument,n=o.defaultView,i=0,r=o.createRange();r.setStart(t,0),r.collapse(!0);for(var l,a=[t],s=!1,d=!1;!d&&(l=a.pop());)if(3==l.nodeType){var c=i+l.length;!s&&e.start>=i&&e.start<=c&&(r.setStart(l,e.start-i),s=!0),s&&e.end>=i&&e.end<=c&&(r.setEnd(l,e.end-i),d=!0),i=c}else for(var u=l.childNodes.length;u--;)a.push(l.childNodes[u]);var p=n.getSelection();p.removeAllRanges(),p.addRange(r)}):document.selection&&(t=function(t){var e=t.ownerDocument,o=(e.defaultView||e.parentWindow,e.selection.createRange()),n=e.body.createTextRange();n.moveToElementText(t),n.setEndPoint("EndToStart",o);var i=n.text.length;return{start:i,end:i+o.text.length}},e=function(t,e){var o=t.ownerDocument,n=(o.defaultView||o.parentWindow,o.body.createTextRange());n.moveToElementText(t),n.collapse(!0),n.moveEnd("character",e.end),n.moveStart("character",e.start),n.select()});var c=function(t,e){var o,n,i;return document.selection&&document.selection.createRange?(o=document.selection.createRange()).parentElement():window.getSelection?((n=window.getSelection()).getRangeAt?n.rangeCount>0&&(o=n.getRangeAt(0)):((o=document.createRange()).setStart(n.anchorNode,n.anchorOffset),o.setEnd(n.focusNode,n.focusOffset),o.collapsed!==n.isCollapsed&&(o.setStart(n.focusNode,n.focusOffset),o.setEnd(n.anchorNode,n.anchorOffset))),t?e?n.focusNode:$(n.focusNode.nodeType===Node.TEXT_NODE?n.focusNode.parentNode:n.focusNode):o?(i=o.commonAncestorContainer,$(3===i.nodeType?i.parentNode:i)):$([])):void 0},u=function(u){o++;var p,f={actionbar:"simple-editor-actionbar",button:"simple-editor-button",content:"simple-editor-content",selected:"simple-editor-button-selected",wrapper:"simple-editor-button-wrapper"},g=i({},f,u.classes),v=u.defaultParagraphSeparator||"div",h=!1,m=[],b=null,k=null,F=$(u.element),y=a("div");y.className=g.actionbar,F.before($(y));var C,w=$(y);[].forEach.call(u.element.children,function(t){t.contentEditable&&(C=t)});var x=!1;C||(x=!0,C=a("div"),m.push(function(){$(C).remove()})),(p=u.element.content=C).contentEditable=!0,$(p).addClass(g.content),m.push(function(){$(p).removeClass("simple-editor-content")}),m.push(r(p,"input",function(t){u.onChange.call(F,p.innerHTML)})),m.push(r(p,"keyup",function(t){var e=t.target.firstChild;c().parents("ul:first").length||c().parents("ol:first").length||(e&&3===e.nodeType?t.shiftKey?d("formatBlock","<br />"):c().is("p"):"<br>"===p.innerHTML&&(p.innerHTML=""))})),m.push(r(p,"keydown",function(t){var e;"Tab"===t.key?t.preventDefault():"Enter"===t.key&&"blockquote"===(e="formatBlock",document.queryCommandValue(e))&&setTimeout(function(){return d("formatBlock","<"+v+">")},0)})),x&&l(u.element,p);var T=a("div");T.className="simple-editor-font-color",T.innerHTML='   <table class="simple-editor-color-grid" role="list" cellspacing="0">         <tbody>         <tr>             <td class="simple-editor-grid-cell">                 <div data-color="#000000" role="option" tabindex="-1" style="background-color: #000000" title="Black"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#993300" role="option" tabindex="-1" style="background-color: #993300" title="Burnt orange"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#333300" role="option" tabindex="-1" style="background-color: #333300" title="Dark olive"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#003300" role="option" tabindex="-1" style="background-color: #003300" title="Dark green"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#003366" role="option" tabindex="-1" style="background-color: #003366" title="Dark azure"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#000080" role="option" tabindex="-1" style="background-color: #000080" title="Navy Blue"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#333399" role="option" tabindex="-1" style="background-color: #333399" title="Indigo"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#333333" role="option" tabindex="-1" style="background-color: #333333" title="Very dark gray"></div>             </td>         </tr>         <tr>             <td class="simple-editor-grid-cell">                 <div data-color="#800000" role="option" tabindex="-1" style="background-color: #800000" title="Maroon"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#FF6600" role="option" tabindex="-1" style="background-color: #FF6600" title="Orange"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#808000" role="option" tabindex="-1" style="background-color: #808000" title="Olive"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#008000" role="option" tabindex="-1" style="background-color: #008000" title="Green"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#008080" role="option" tabindex="-1" style="background-color: #008080" title="Teal"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#0000FF" role="option" tabindex="-1" style="background-color: #0000FF" title="Blue"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#666699" role="option" tabindex="-1" style="background-color: #666699" title="Grayish blue"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#808080" role="option" tabindex="-1" style="background-color: #808080" title="Gray"></div>             </td>         </tr>         <tr>             <td class="simple-editor-grid-cell">                 <div data-color="#FF0000" role="option" tabindex="-1" style="background-color: #FF0000" title="Red"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#FF9900" role="option" tabindex="-1" style="background-color: #FF9900" title="Amber"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#99CC00" role="option" tabindex="-1" style="background-color: #99CC00" title="Yellow green"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#339966" role="option" tabindex="-1" style="background-color: #339966" title="Sea green"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#33CCCC" role="option" tabindex="-1" style="background-color: #33CCCC" title="Turquoise"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#3366FF" role="option" tabindex="-1" style="background-color: #3366FF" title="Royal blue"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#800080" role="option" tabindex="-1" style="background-color: #800080" title="Purple"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#999999" role="option" tabindex="-1" style="background-color: #999999" title="Medium gray"></div>             </td>         </tr>         <tr>             <td class="simple-editor-grid-cell">                 <div data-color="#FF00FF" role="option" tabindex="-1" style="background-color: #FF00FF" title="Magenta"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#FFCC00" role="option" tabindex="-1" style="background-color: #FFCC00" title="Gold"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#FFFF00" role="option" tabindex="-1" style="background-color: #FFFF00" title="Yellow"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#00FF00" role="option" tabindex="-1" style="background-color: #00FF00" title="Lime"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#00FFFF" role="option" tabindex="-1" style="background-color: #00FFFF" title="Aqua"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#00CCFF" role="option" tabindex="-1" style="background-color: #00CCFF" title="Sky blue"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#993366" role="option" tabindex="-1" style="background-color: #993366" title="Red violet"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#FFFFFF" role="option" tabindex="-1" style="background-color: #FFFFFF" title="White"></div>             </td>         </tr>         <tr>             <td class="simple-editor-grid-cell">                 <div data-color="#FF99CC" role="option" tabindex="-1" style="background-color: #FF99CC" title="Pink"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#FFCC99" role="option" tabindex="-1" style="background-color: #FFCC99" title="Peach"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#FFFF99" role="option" tabindex="-1" style="background-color: #FFFF99" title="Light yellow"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#CCFFCC" role="option" tabindex="-1" style="background-color: #CCFFCC" title="Pale green"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#CCFFFF" role="option" tabindex="-1" style="background-color: #CCFFFF" title="Pale cyan"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#99CCFF" role="option" tabindex="-1" style="background-color: #99CCFF" title="Light sky blue"></div>             </td>             <td class="simple-editor-grid-cell">                 <div data-color="#CC99FF" role="option" tabindex="-1" style="background-color: #CC99FF" title="Plum"></div>             </td>             <td class="simple-editor-grid-cell">                 <div style="text-align: center;" data-color="transparent" role="option" tabindex="-1" style="background-color: transparent" title="No color">X</div>             </td>         </tr>         </tbody>    </table>  ';var L=$(T);L.hide(),w.append(T);var S=a("div");S.className="simple-editor-dropdown",S.innerHTML='<div class="simple-editor-dropdown-inner"></div>';var E=$(S);E.hide(),w.append(S),E.on("click",".simple-editor-dropdown-item",function(t){var o=$(this).attr("data-target"),n=H[o];b&&(e(p,b),b=null),t.preventDefault();var i=n.result()&&p.focus();return I(),i});var N=function(){h=!1,L.hide(),E.hide()};L.on("click",".simple-editor-grid-cell div",function(){e(p,b);var t=$(this).data("color");(d("foreColor",t),"transparent"===t)&&(c(!0).removeAttr("color"),u.onChange.call(F,p.innerHTML));$(".color-preview").css("background",t),N()}),m.push(r(document,"click",function(t){if(t.target){if(h)return void(h=!1);var e=$(t.target);if(e.is(".simple-editor-dropdown")||e.parents(".simple-editor-dropdown:first").length||e.is(".simple-editor-font-color")||e.parents(".simple-editor-font-color:first").length)return;N()}})),m.push(function(){L.remove(),E.remove()}),F.addClass("simple-editor"),m.push(function(){F.removeClass("simple-editor")});var R=function(t){for(var e=t.parentNode;t.firstChild;)e.insertBefore(t.firstChild,t);e.removeChild(t),u.onChange.call(F,p.innerHTML)},j=function(t){var e=c(),o=d(t?"insertOrderedList":"insertUnorderedList"),n=e.find(t?"ol":"ul"),i=n.first("li:first").contents().get(0);return R(n.parents("p:first").get(0)),function(t){if(void 0!==window.getSelection){var e=document.createRange();e.setStartAfter(t),e.collapse(!0);var o=window.getSelection();o.removeAllRanges(),o.addRange(e)}}(i),o},D=function(e,o,n){var i={groups:n,icon:e.join(" "),title:o,getIcon:function(){i.groups.forEach(function(t){var o=H[t];$(o.wrapper).hasClass(g.selected)&&$(i.wrapper).find("button").html($(o.wrapper).find("button").html()+" "+e[1])})},extraClass:"simple-editor-responsive-button",state:function(){var t=!1;return i.groups.forEach(function(e){H[e].state()&&(t=!0)}),t},result:function(){b=t(p);var e,o,n=[];i.groups.forEach(function(t){n.push('<div class="simple-editor-dropdown-item" data-target="'+t+'">'+H[t].wrapper.outerHTML+"</div>")}),e=$(i.wrapper),o=n.join(""),h=!0,E.find(".simple-editor-dropdown-inner").html(o),E.css("left",e.position().left),E.css("top","35px"),E.show()}};return i},B=function(t){var e="h"+t;return{icon:"<b>H<sub>"+t+"</sub></b>",extraClass:"simple-editor-hsc",title:"Heading "+t,state:function(){return c().is(e)||c().parents(e+":first").length},result:function(){c();if(c().is(e)||c().parents(e+":first").length)return!0;var t=d("formatBlock","<"+e+">");return window.wpghTextBlock&&(wpghTextBlock.h1Font.trigger("change"),wpghTextBlock.h1Size.trigger("change"),wpghTextBlock.h2Font.trigger("change"),wpghTextBlock.h2Size.trigger("change")),t}}},H={bold:{icon:'<span class="dashicons dashicons-editor-bold"></span>',title:"Bold",state:function(){return s("bold")},result:function(){return d("bold")}},italic:{icon:'<span class="dashicons dashicons-editor-italic"></span>',title:"Italic",state:function(){return s("italic")},result:function(){return d("italic")}},underline:{icon:'<span class="dashicons dashicons-editor-underline"></span>',title:"Underline",state:function(){return s("underline")},result:function(){return d("underline")}},color:{icon:'<span class="dashicons simple-editor-color-picker-handle dashicons-editor-textcolor"><span class="color-preview"></span></span>',title:"Color",state:function(){return s("foreColor")},result:function(){return h=!0,b=t(p),L.css("left",$(".simple-editor-color-picker-handle").parents(".simple-editor-button-wrapper:first").position().left),L.css("top","35px"),L.show(),!0}},strikethrough:{icon:'<span class="dashicons dashicons-editor-strikethrough"></span>',title:"Strike-through",state:function(){return s("strikeThrough")},result:function(){return d("strikeThrough")}},alignLeft:{icon:'<span class="dashicons dashicons-editor-alignleft"></span>',title:"Left alignment",extraClass:"simple-editor-hsc",state:function(){return s("justifyLeft")},result:function(){return d("justifyLeft")}},alignRight:{icon:'<span class="dashicons dashicons-editor-alignright"></span>',title:"Right alignment",extraClass:"simple-editor-hsc",state:function(){return s("justifyRight")},result:function(){return d("justifyRight")}},alignCenter:{icon:'<span class="dashicons dashicons-editor-aligncenter"></span>',title:"Center alignment",extraClass:"simple-editor-hsc",state:function(){return s("justifyCenter")},result:function(){return d("justifyCenter")}},alignJustify:{icon:'<span class="dashicons dashicons-editor-justify"></span>',title:"Justify alignment",extraClass:"simple-editor-hsc",state:function(){return s("justifyFull")},result:function(){return d("justifyFull")}},heading1:B("1"),heading2:B("2"),olist:{icon:'<span class="dashicons dashicons-editor-ol"></span>',title:"Ordered List",state:function(){return s("insertOrderedList")},result:function(){return j(!0)}},ulist:{icon:'<span class="dashicons dashicons-editor-ul"></span>',title:"Unordered List",state:function(){return s("insertUnorderedList")},result:function(){return j(!1)}},paragraph:{icon:"&#182;",title:"Paragraph",extraClass:"simple-editor-hsc",state:function(){var t=c();return t.is("p")||t.parents("p:first").length},result:function(){var t=c();if(t.is("p")||t.parents("p:first").length)return!0;var e=!1;return["ul","ol"].forEach(function(o){var n=t.parents(o+":first");if(n.length||(n=t.find(o)),n.length){e=!0;var i="";n.find("li").each(function(){i+=$(this).html()});n.wrap("<p>"),n.parents("p:first").html(i)}}),t.attr("style",""),!!e||d("formatBlock","<p>")}},link:{icon:'<span class="dashicons link-manager dashicons-admin-links"></span>',title:"Link",state:function(){return c().is("a")},result:function(){var n=c(),i=n.is("a");prompt;return(window.wpLink?function(){k=t(p);var r="textarea-simple-editor"+o,s=$("#"+r);s.length||((s=$(a("textarea"))).attr("id",r),s.hide(),l(u.element,s),m.push(function(){s.remove()}));var f,g="",v=(f="",window.getSelection?f=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(f=document.selection.createRange().text),f||""),h=c();i&&(g=n.attr("href"),v=n.text());var b=function(){$("#wp-link-url").val(g)};$(document).on("wplink-open",b),wpLink.open(r,g,v);var y=function(){$(document).off("wplink-open",b),$("body").off("click","#wp-link-submit",C).off("click","#wp-link-cancel, #wp-link-close",w),u.onChange.call(F,p.innerHTML)},C=function(t){var o=$.parseHTML(s.val());s.val("");var r=null;if($(o).each(function(){r=$(this)}),r){var l=r.attr("href");e(p,k);var a=r.contents().get(0).nodeValue;if(i)n.attr("href",l),n.text(a);else{var c=document.getSelection();d("createLink",l),h.is("a")?h.text(a):($(c.anchorNode).text(a),console.log(h,c.anchorNode))}}return y(),wpLink.close(),t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation(),!1},w=function(t){return e(p,k),y(),wpLink.close(),t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation(),!1};$("body").on("click","#wp-link-submit",C).on("click","#wp-link-cancel, #wp-link-close",w)}:function(){if(i){var t=prompt("Edit Link",n.attr("href"));return n.attr("href",t),!0}var e=window.prompt("Enter the link URL");e&&d("createLink",e)})(),!0}},unlink:{icon:'<span class="dashicons link-manager-unlink dashicons-editor-unlink"></span>',title:"Unlink",extraClass:"simple-editor-unlink-c",state:function(){var t=c().is("a"),e=$(u.element).find(".link-manager-unlink").parents(".simple-editor-button-wrapper:first");return t?e.show():e.hide(),t},result:function(){return c().is("a")&&R(c()[0]),!0}},responsiveHeadings:D(["<b>H<sub>1</sub></b>",'<span class="dashicons dicon-sm dashicons-arrow-down-alt2"></span>'],"Headings",["paragraph","heading1","heading2"]),responsiveAlign:D(['<span class="dashicons dashicons-editor-alignleft"></span>','<span class="dashicons dicon-sm dashicons-arrow-down-alt2"></span>'],"Alignments",["alignLeft","alignRight","alignCenter","alignJustify"])},O=Object.keys(H),P=u.actions?u.actions.map(function(t){return"string"==typeof t?H[t]:H[t.name]?i({},H[t.name],t):t}):O.map(function(t){return H[t]}),M=[],A=null,I=function(){return A&&clearTimeout(A),A=setTimeout(function(){M.forEach(function(t){t()})},100),!0};return P.reverse(),P.forEach(function(t){n++,t.nextId=n;var e=a("button"),o="simple-editor-action-t-"+t.nextId;e.className=g.button,e.innerHTML=t.icon,e.title=t.title,e.setAttribute("type","button"),r(e,"click",function(){return t.result()&&p.focus()});var i,s=a("div");s.className=f.wrapper+" "+o,t.extraClass&&(s.className+=" "+t.extraClass),s.appendChild(e),t.state&&(i=function(){$("."+o).each(function(){$(this)[t.state()?"addClass":"removeClass"](g.selected).find("button")[t.state()?"addClass":"removeClass"](g.selected)}),t.getIcon&&t.getIcon()},M.push(i),m.push(r(p,"keyup",I)),m.push(r(p,"mouseup",I)),m.push(r(e,"click",I))),t.wrapper=s,l(y,s),i&&i(),t.getIcon&&t.getIcon()}),u.styleWithCSS&&d("styleWithCSS"),d("defaultParagraphSeparator",v),{destroy:function(){y.parentNode&&(m.forEach(function(t){t()}),y.parentNode.removeChild(y),u.afterDestroy&&u.afterDestroy.call(F,u))}}},p={exec:d,init:u};exports.exec=d,exports.init=u,exports.default=p,Object.defineProperty(exports,"__esModule",{value:!0})}),function($){$.fn.simpleEditor=function(t){t=t||{};var e={callbacks:[],destroy:function(){e.callbacks.forEach(function(t){t()})}};return this.each(function(){var o=$(this),n=o.data("simpleEditor");return n?(e.callbacks.push(function(){n.destroy()}),n):(n=simpleeditor.init({element:o[0],actions:t.actions,defaultParagraphSeparator:t.defaultParagraphSeparator,onChange:t.change||function(){},afterDestroy:function(){o.data("simpleEditor",null)}}),e.callbacks.push(function(){n.destroy()}),o.data("simpleEditor",n),n)}),e}}(jQuery);